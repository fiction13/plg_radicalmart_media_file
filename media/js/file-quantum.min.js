"use strict";window.RadicalMartFieldGalleryFileQuantum={select(e){let t=e.closest('[radicalmart-field-gallery="container"]');if(!t)return;let a=Joomla.Modal.getCurrent();if(!a)return;let r=a.querySelector("iframe");if(!r)return;let l=r.contentWindow;if(!l)return;let o=l.QuantummanagerLists,i=l.QuantumUtils;if(!o||!i)return;let n=[];o.forEach((e=>{e.Quantumviewfiles.element.querySelectorAll(".field-list-files .file-item").forEach((t=>{t.querySelector("input").checked&&n.push({path:e.data.path,name:t.querySelector(".file-name").innerHTML,scope:e.data.scope,preview:t.getAttribute("data-filep")})}))})),0!==n.length&&Promise.all(n.map((e=>{let t=i.getFullUrl("index.php?option=com_quantummanager&task=quantumviewfiles.getParsePath&path="+encodeURIComponent(e.path+"/"+e.name)+"&scope="+e.scope);return new Promise(((a,r)=>{Joomla.request({url:t,data:{},method:"POST",onSuccess:t=>a({file:e,response:t}),onError:e=>r(e)})}))}))).then((e=>{e.forEach((e=>{try{let a=JSON.parse(e.response);if(a.path){let e=a.path,r=window.RadicalMartFieldGallery.getTypeTemplate(t,"file");if(r){r.querySelector('input[data-name*="[type]"]').value="file",r.querySelector('input[data-name*="[src]"]').setAttribute("value",e);let a=r.querySelector('[radicalmart-field-gallery="preview"]');a&&a.setAttribute("src",Joomla.getOptions("system.paths").rootFull+e),window.RadicalMartFieldGallery.appendItem(t,r)}}}catch(e){Joomla.renderMessages({error:["RadicalMartGalleryFile: "+e.message]}),a.close()}})),a.close()})).catch((e=>{Joomla.renderMessages({error:["RadicalMartGalleryFile: "+e.message]}),a.close()}))}},document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll('[radicalmart-field-gallery="container"]').forEach((e=>{let t=e.querySelector('[id*="_modal_type_file"]');t&&t.addEventListener("shown.bs.modal",(e=>{let t=e.target.querySelector("iframe");Joomla.Modal.setCurrent(e.target),t&&t.addEventListener("load",(()=>{let a=t.contentWindow;a&&a.Joomla.Modal.setCurrent(e.target)}))}))}))}));